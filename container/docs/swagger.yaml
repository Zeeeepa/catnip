definitions:
  github_com_vanpelt_catnip_internal_models.ClaudeHistoryEntry:
    properties:
      display:
        type: string
      pastedContents:
        additionalProperties: {}
        type: object
    type: object
  github_com_vanpelt_catnip_internal_models.ClaudeSessionMessage:
    properties:
      cwd:
        type: string
      isMeta:
        type: boolean
      isSidechain:
        type: boolean
      message:
        additionalProperties: {}
        type: object
      parentUuid:
        type: string
      sessionId:
        type: string
      timestamp:
        type: string
      type:
        type: string
      userType:
        type: string
      uuid:
        type: string
      version:
        type: string
    type: object
  github_com_vanpelt_catnip_internal_models.ClaudeSessionSummary:
    description: Claude Code session summary with metrics and timing information
    properties:
      allSessions:
        description: List of all available sessions for this worktree
        items:
          $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.SessionListEntry'
        type: array
      currentSessionId:
        description: ID of the currently active session
        example: xyz789-ghi012
        type: string
      isActive:
        description: Whether this session is currently active
        example: true
        type: boolean
      lastCost:
        description: |-
          Metrics (from completed sessions)
          Cost in USD of the last completed session
        example: 0.25
        type: number
      lastDuration:
        description: Duration in seconds of the last session
        example: 3600
        type: integer
      lastSessionId:
        description: ID of the most recent completed session
        example: abc123-def456
        type: string
      lastTotalInputTokens:
        description: Total input tokens used in the last session
        example: 15000
        type: integer
      lastTotalOutputTokens:
        description: Total output tokens generated in the last session
        example: 8500
        type: integer
      sessionEndTime:
        description: When the last session ended (if not active)
        example: "2024-01-15T16:45:30Z"
        type: string
      sessionStartTime:
        description: When the current session started
        example: "2024-01-15T14:30:00Z"
        type: string
      turnCount:
        description: Number of conversation turns in the session
        example: 15
        type: integer
      worktreePath:
        description: Path to the worktree directory
        example: /workspace/my-project
        type: string
    type: object
  github_com_vanpelt_catnip_internal_models.FullSessionData:
    description: Complete session data with all messages and metadata
    properties:
      allSessions:
        description: All sessions available for this workspace
        items:
          $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.SessionListEntry'
        type: array
      messageCount:
        description: Total message count in full data
        type: integer
      messages:
        description: Full conversation history (only when full=true)
        items:
          $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.ClaudeSessionMessage'
        type: array
      sessionInfo:
        allOf:
        - $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.ClaudeSessionSummary'
        description: Basic session information
      userPrompts:
        description: User prompts from ~/.claude.json (only when full=true)
        items:
          $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.ClaudeHistoryEntry'
        type: array
    type: object
  github_com_vanpelt_catnip_internal_models.GitStatus:
    description: Current git status including repository information
    properties:
      repositories:
        additionalProperties:
          $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.Repository'
        description: All loaded repositories mapped by repository ID
        type: object
      worktree_count:
        description: Total number of worktrees across all repositories
        example: 3
        type: integer
    type: object
  github_com_vanpelt_catnip_internal_models.Repository:
    description: Git repository information and metadata
    properties:
      created_at:
        description: When this repository was first cloned
        example: "2024-01-15T10:30:00Z"
        type: string
      default_branch:
        description: Default branch name for this repository
        example: main
        type: string
      id:
        description: Repository identifier in owner/repo format
        example: anthropics/claude-code
        type: string
      last_accessed:
        description: When this repository was last accessed
        example: "2024-01-15T16:45:30Z"
        type: string
      path:
        description: Local path to the bare repository
        example: /workspace/repos/anthropics_claude-code.git
        type: string
      url:
        description: Full GitHub repository URL
        example: https://github.com/anthropics/claude-code
        type: string
    type: object
  github_com_vanpelt_catnip_internal_models.SessionListEntry:
    description: Session list entry with basic metadata
    properties:
      endTime:
        description: When the session ended (if available)
        example: "2024-01-15T16:45:30Z"
        type: string
      isActive:
        description: Whether this session is currently active
        example: false
        type: boolean
      lastModified:
        description: When the session was last modified
        example: "2024-01-15T16:45:30Z"
        type: string
      sessionId:
        description: Unique session identifier
        example: abc123-def456-ghi789
        type: string
      startTime:
        description: When the session started (if available)
        example: "2024-01-15T14:30:00Z"
        type: string
    type: object
  github_com_vanpelt_catnip_internal_models.Worktree:
    description: Git worktree with branch and status information
    properties:
      branch:
        description: Current git branch name in this worktree
        example: feature/api-docs
        type: string
      commit_count:
        description: Number of commits ahead of the divergence point (CommitHash)
        example: 3
        type: integer
      commit_hash:
        description: Commit hash where this worktree diverged from source branch (updated
          after merges)
        example: abc123def456
        type: string
      commits_behind:
        description: Number of commits the source branch is ahead of our divergence
          point
        example: 2
        type: integer
      created_at:
        description: When this worktree was created
        example: "2024-01-15T14:00:00Z"
        type: string
      id:
        description: Unique identifier for this worktree
        example: abc123-def456-ghi789
        type: string
      is_dirty:
        description: Whether there are uncommitted changes in the worktree
        example: true
        type: boolean
      last_accessed:
        description: When this worktree was last accessed
        example: "2024-01-15T16:30:00Z"
        type: string
      name:
        description: User-friendly name for this worktree (e.g., 'vectorize-quasar')
        example: feature-api-docs
        type: string
      path:
        description: Absolute path to the worktree directory
        example: /workspace/worktrees/feature-api-docs
        type: string
      repo_id:
        description: Repository this worktree belongs to
        example: anthropics/claude-code
        type: string
      source_branch:
        description: Branch this worktree was originally created from
        example: main
        type: string
    type: object
  github_com_vanpelt_catnip_internal_services.ServiceInfo:
    properties:
      health:
        type: string
      last_seen:
        type: string
      pid:
        type: integer
      port:
        type: integer
      service_type:
        type: string
      title:
        type: string
    type: object
  internal_handlers.ActiveSessionInfo:
    description: Active session information with timing and Claude session details
    properties:
      claude_session_uuid:
        description: Unique identifier for the Claude session
        example: abc123-def456-ghi789
        type: string
      ended_at:
        description: When the session ended (if not active)
        example: "2024-01-15T18:30:00Z"
        type: string
      resumed_at:
        description: When the session was resumed (if applicable)
        example: "2024-01-15T16:00:00Z"
        type: string
      started_at:
        description: When the session was initially started
        example: "2024-01-15T14:30:00Z"
        type: string
    type: object
  internal_handlers.AuthStartResponse:
    description: Response when starting GitHub device flow authentication
    properties:
      code:
        description: Device verification code to enter on GitHub
        example: 1234-5678
        type: string
      status:
        description: Current authentication status
        example: waiting
        type: string
      url:
        description: GitHub device activation URL
        example: https://github.com/login/device
        type: string
    type: object
  internal_handlers.AuthStatusResponse:
    description: Response containing the current authentication status
    properties:
      error:
        description: Error message if authentication failed
        example: authentication timeout
        type: string
      status:
        description: 'Authentication status: pending, waiting, success, or error'
        example: success
        type: string
    type: object
  internal_handlers.CheckoutResponse:
    description: Response containing repository and worktree information after checkout
    properties:
      message:
        description: Success message
        example: Repository checked out successfully
        type: string
      repository:
        allOf:
        - $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.Repository'
        description: Repository information
      worktree:
        allOf:
        - $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.Worktree'
        description: Created worktree information
    type: object
  internal_handlers.ConflictCheckResponse:
    description: Response containing conflict information for sync/merge operations
    properties:
      conflict_files:
        description: List of files with conflicts
        example:
        - '["src/main.go"'
        - ' "README.md"]'
        items:
          type: string
        type: array
      has_conflicts:
        description: Whether conflicts were detected
        example: true
        type: boolean
      message:
        description: Status message
        example: No conflicts detected
        type: string
      operation:
        description: Operation type (sync/merge)
        example: sync
        type: string
      worktree_name:
        description: Name of the worktree
        example: feature-branch
        type: string
    type: object
  internal_handlers.DeleteSessionResponse:
    description: Response confirming session deletion
    properties:
      message:
        description: Confirmation message
        example: Session deleted successfully
        type: string
      workspace:
        description: Workspace path that was deleted
        example: /workspace/my-project
        type: string
    type: object
  internal_handlers.GitHubRepository:
    description: GitHub repository information from the GitHub API
    properties:
      clone_url:
        description: Git clone URL
        example: https://github.com/anthropics/claude-code.git
        type: string
      description:
        description: Repository description
        example: AI coding assistant
        type: string
      full_name:
        description: Full repository name (org/repo)
        example: anthropics/claude-code
        type: string
      html_url:
        description: Repository URL
        example: https://github.com/anthropics/claude-code
        type: string
      id:
        description: GitHub repository ID
        example: 123456789
        type: integer
      name:
        description: Repository name
        example: claude-code
        type: string
      private:
        description: Whether the repository is private
        example: false
        type: boolean
    type: object
  internal_handlers.SessionsResponse:
    additionalProperties:
      $ref: '#/definitions/internal_handlers.ActiveSessionInfo'
    description: Map of workspace paths to session information
    type: object
  internal_handlers.UploadResponse:
    description: Response containing upload status and file location
    properties:
      filePath:
        description: Path where the uploaded file was saved
        example: /tmp/uploads/document.pdf
        type: string
      message:
        description: Status message or error details
        example: File uploaded successfully
        type: string
      success:
        description: Whether the upload succeeded
        example: true
        type: boolean
    type: object
  internal_handlers.WorktreeDiffResponse:
    description: Response containing git diff information for a worktree
    properties:
      additions:
        description: Number of lines added
        example: 25
        type: integer
      deletions:
        description: Number of lines deleted
        example: 10
        type: integer
      diff:
        description: Raw git diff output
        example: diff --git a/main.go b/main.go...
        type: string
      files_changed:
        description: List of changed files
        example:
        - '["main.go"'
        - ' "README.md"]'
        items:
          type: string
        type: array
      summary:
        description: Diff summary
        example: 2 files changed, 25 insertions(+), 10 deletions(-)
        type: string
    type: object
  internal_handlers.WorktreeOperationResponse:
    description: Response for worktree operations like delete, sync, merge, preview
    properties:
      id:
        description: Worktree ID
        example: abc123-def456-ghi789
        type: string
      message:
        description: Operation result message
        example: Worktree deleted successfully
        type: string
      strategy:
        description: Strategy used for sync operations
        example: rebase
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  description: API for managing container PTY sessions and services
  title: Catnip Container API
  version: "1.0"
paths:
  /v1/auth/github/start:
    post:
      description: Initiates GitHub device flow authentication
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.AuthStartResponse'
      summary: Start GitHub authentication
      tags:
      - auth
  /v1/auth/github/status:
    get:
      description: Returns the current status of the authentication flow
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.AuthStatusResponse'
      summary: Get authentication status
      tags:
      - auth
  /v1/claude/session:
    get:
      description: Returns Claude Code session metadata for a specific worktree
      parameters:
      - description: Worktree path
        in: query
        name: worktree_path
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.ClaudeSessionSummary'
      summary: Get worktree session summary
      tags:
      - claude
  /v1/claude/session/{uuid}:
    get:
      description: Returns complete session data including all messages for a specific
        session UUID
      parameters:
      - description: Session UUID
        in: path
        name: uuid
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.FullSessionData'
      summary: Get session by UUID
      tags:
      - claude
  /v1/claude/sessions:
    get:
      description: Returns Claude Code session metadata for all worktrees with Claude
        data
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.ClaudeSessionSummary'
            type: object
      summary: Get all worktree session summaries
      tags:
      - claude
  /v1/git/branches/{repo_id}:
    get:
      description: Returns a list of remote branches for a specific repository
      parameters:
      - description: Repository ID
        in: path
        name: repo_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              type: string
            type: array
      summary: Get repository branches
      tags:
      - git
  /v1/git/checkout/{org}/{repo}:
    post:
      consumes:
      - application/json
      description: Clones a GitHub repository as a bare repo and creates initial worktree
      parameters:
      - description: Organization name
        in: path
        name: org
        required: true
        type: string
      - description: Repository name
        in: path
        name: repo
        required: true
        type: string
      - description: Branch name (optional)
        in: query
        name: branch
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.CheckoutResponse'
      summary: Checkout a GitHub repository
      tags:
      - git
  /v1/git/github/repos:
    get:
      description: Returns a list of GitHub repositories accessible to the authenticated
        user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_handlers.GitHubRepository'
            type: array
      summary: List GitHub repositories
      tags:
      - git
  /v1/git/status:
    get:
      description: Returns the current repository and worktree status
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.GitStatus'
      summary: Get Git status
      tags:
      - git
  /v1/git/worktrees:
    get:
      description: Returns a list of all worktrees for the current repository
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.Worktree'
            type: array
      summary: List all worktrees
      tags:
      - git
  /v1/git/worktrees/{id}:
    delete:
      description: Removes a worktree from the repository
      parameters:
      - description: Worktree ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.WorktreeOperationResponse'
      summary: Delete worktree
      tags:
      - git
  /v1/git/worktrees/{id}/diff:
    get:
      description: Returns the diff for a worktree against its source branch, including
        all staged/unstaged changes
      parameters:
      - description: Worktree ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.WorktreeDiffResponse'
      summary: Get worktree diff
      tags:
      - git
  /v1/git/worktrees/{id}/merge:
    post:
      consumes:
      - application/json
      description: Merges a local repo worktree's changes back to the main repository
      parameters:
      - description: Worktree ID
        in: path
        name: id
        required: true
        type: string
      - description: Merge options
        in: body
        name: body
        schema:
          additionalProperties:
            type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.WorktreeOperationResponse'
      summary: Merge worktree to main
      tags:
      - git
  /v1/git/worktrees/{id}/merge/check:
    get:
      description: Checks if merging a worktree to main would cause conflicts
      parameters:
      - description: Worktree ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.ConflictCheckResponse'
      summary: Check merge conflicts
      tags:
      - git
  /v1/git/worktrees/{id}/preview:
    post:
      description: Creates a preview branch in the main repo for viewing changes outside
        container
      parameters:
      - description: Worktree ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.WorktreeOperationResponse'
      summary: Create worktree preview
      tags:
      - git
  /v1/git/worktrees/{id}/sync:
    post:
      consumes:
      - application/json
      description: Syncs a worktree with its source branch using merge or rebase strategy
      parameters:
      - description: Worktree ID
        in: path
        name: id
        required: true
        type: string
      - description: Sync options
        in: body
        name: body
        required: true
        schema:
          additionalProperties:
            type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.WorktreeOperationResponse'
      summary: Sync worktree with source branch
      tags:
      - git
  /v1/git/worktrees/{id}/sync/check:
    get:
      description: Checks if syncing a worktree would cause merge conflicts
      parameters:
      - description: Worktree ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.ConflictCheckResponse'
      summary: Check sync conflicts
      tags:
      - git
  /v1/ports:
    get:
      consumes:
      - application/json
      description: Returns a list of all currently detected ports with their service
        information
      produces:
      - application/json
      responses:
        "200":
          description: List of detected ports and services
          schema:
            additionalProperties: true
            type: object
      summary: Get detected ports
      tags:
      - ports
  /v1/ports/{port}:
    get:
      consumes:
      - application/json
      description: Returns detailed information about a specific port if it exists
      parameters:
      - description: Port number
        in: path
        name: port
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Port information
          schema:
            $ref: '#/definitions/github_com_vanpelt_catnip_internal_services.ServiceInfo'
        "404":
          description: Port not found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get port information
      tags:
      - ports
  /v1/pty:
    get:
      description: Establishes a WebSocket connection for terminal access
      parameters:
      - description: Session ID
        in: query
        name: session
        required: true
        type: string
      responses:
        "101":
          description: Switching Protocols
          schema:
            type: string
      summary: Create PTY WebSocket connection
      tags:
      - pty
  /v1/sessions:
    get:
      description: Returns all sessions including ended ones
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.SessionsResponse'
      summary: Get all sessions
      tags:
      - sessions
  /v1/sessions/active:
    get:
      description: Returns all active sessions (not ended)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.SessionsResponse'
      summary: Get active sessions
      tags:
      - sessions
  /v1/sessions/workspace/{workspace}:
    delete:
      description: Removes a session from the active sessions mapping
      parameters:
      - description: Workspace directory path
        in: path
        name: workspace
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.DeleteSessionResponse'
      summary: Delete session
      tags:
      - sessions
    get:
      description: Returns session information for a specific workspace directory.
        Use ?full=true for complete session data including messages.
      parameters:
      - description: Workspace directory path
        in: path
        name: workspace
        required: true
        type: string
      - description: Include full session data with messages and user prompts
        in: query
        name: full
        type: boolean
      produces:
      - application/json
      responses:
        "200":
          description: Full session data when full=true
          schema:
            $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.FullSessionData'
      summary: Get session by workspace
      tags:
      - sessions
  /v1/sessions/workspace/{workspace}/session/{sessionId}:
    get:
      description: Returns complete session data for a specific session ID within
        a workspace
      parameters:
      - description: Workspace directory path
        in: path
        name: workspace
        required: true
        type: string
      - description: Session ID (UUID)
        in: path
        name: sessionId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_vanpelt_catnip_internal_models.FullSessionData'
      summary: Get session by ID
      tags:
      - sessions
  /v1/upload:
    post:
      consumes:
      - multipart/form-data
      description: Upload a file to /tmp/uploads directory with automatic conflict
        resolution
      parameters:
      - description: File to upload
        in: formData
        name: file
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_handlers.UploadResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/internal_handlers.UploadResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/internal_handlers.UploadResponse'
      summary: Upload a file
      tags:
      - upload
schemes:
- http
- ws
swagger: "2.0"
